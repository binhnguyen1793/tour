<?php
/**
 * Template for displaying single Combo post
 */
get_header();
global $post;

$anh_dai_dien = get_field('anh_dai_dien');
$thu_vien_anh = get_field('thu_vien_anh');
$khoi_hanh_tu = get_field('khoi_hanh_tu');
$dia_diem = get_field('dia_diem');
$ngay_di = get_field('ngay_di');
$thoi_gian = get_field('thoi_gian');
$combo_bao_gom = get_field('combo_bao_gom');
$mo_ta_ngan = get_field('mo_ta_ngan');
$diem_noi_bat = get_field('diem_noi_bat');
$gia_bang = get_field('gia_bang');
$gia_bao_gom = get_field('gia_bao_gom');
$gia_khong_bao_gom = get_field('gia_khong_bao_gom');
?>

<div class="combo-container" style="max-width:1140px;margin:auto;padding:24px">
    <div class="combo-header" style="display:flex;gap:32px;flex-wrap:wrap">
        <div style="flex:1;min-width:300px">
            <img src="<?= esc_url($anh_dai_dien['url']) ?>" alt="" style="width:100%;border-radius:8px">
            <?php if ($thu_vien_anh): ?>
                <div style="display:flex;gap:8px;margin-top:12px;overflow-x:auto">
                    <?php foreach ($thu_vien_anh as $img): ?>
                        <img src="<?= esc_url($img['sizes']['thumbnail']) ?>" style="height:64px;border-radius:6px">
                    <?php endforeach; ?>
                </div>
            <?php endif; ?>
        </div>

        <div style="flex:1;min-width:300px">
            <h1><?php the_title(); ?></h1>
            <p><strong>Khởi hành từ:</strong> <?= esc_html($khoi_hanh_tu) ?> &nbsp;|&nbsp; <strong>Địa điểm:</strong> <?= esc_html($dia_diem) ?></p>
            <p><strong>Ngày đi:</strong> <?= esc_html($ngay_di) ?> &nbsp;|&nbsp; <strong>Thời gian:</strong> <?= esc_html($thoi_gian) ?></p>
            <div style="margin-top:16px">
                <strong>Combo bao gồm:</strong>
                <ul>
                    <?php foreach (explode("\n", $combo_bao_gom) as $line): ?>
                        <li><?= esc_html($line) ?></li>
                    <?php endforeach; ?>
                </ul>
            </div>
            <a href="#form" style="display:inline-block;margin-top:12px;padding:12px 20px;background:#f60;color:#fff;font-weight:bold;border-radius:6px">Gửi yêu cầu</a>
        </div>
    </div>

    <div style="margin-top:40px">
        <ul style="display:flex;gap:24px;padding:0;margin:0;list-style:none;border-bottom:2px solid #eee">
            <li><a href="#gioi-thieu" style="padding:12px 0;display:inline-block;font-weight:bold;border-bottom:2px solid #f60">Giới thiệu</a></li>
            <li><a href="#bang-gia">Bảng giá</a></li>
            <li><a href="#quy-dinh">Quy định</a></li>
            <li><a href="#hoi-dap">Hỏi đáp</a></li>
        </ul>

        <div id="gioi-thieu" style="margin-top:24px">
            <div><?= wpautop($mo_ta_ngan) ?></div>
            <?php if ($diem_noi_bat): ?>
                <h3>Điểm nổi bật</h3>
                <ul>
                    <?php foreach (explode("\n", $diem_noi_bat) as $line): ?>
                        <li style="list-style:'\2713\0020';margin-left:20px"> <?= esc_html($line) ?></li>
                    <?php endforeach; ?>
                </ul>
            <?php endif; ?>
        </div>

        <div id="bang-gia" style="margin-top:40px">
            <h3>Bảng giá</h3>
            <table style="width:100%;border-collapse:collapse;border:1px solid #ccc">
                <thead>
                    <tr style="background:#f5f5f5">
                        <th style="padding:10px;border:1px solid #ccc">Ngày khởi hành</th>
                        <th style="padding:10px;border:1px solid #ccc">Hạng giá combo</th>
                        <th style="padding:10px;border:1px solid #ccc">Giá combo</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    <?php foreach ($gia_bang as $row): ?>
                        <tr>
                            <td style="padding:10px;border:1px solid #ccc"><?= esc_html($row['ngay']) ?></td>
                            <td style="padding:10px;border:1px solid #ccc"><?= esc_html($row['hang']) ?></td>
                            <td style="padding:10px;border:1px solid #ccc"><?= number_format($row['gia'], 0, ',', '.') ?> đ</td>
                            <td style="padding:10px"><a href="#form" style="background:#f90;color:#fff;padding:6px 12px;border-radius:4px;font-weight:bold">Đặt ngay</a></td>
                        </tr>
                    <?php endforeach; ?>
                </tbody>
            </table>
        </div>

        <div id="quy-dinh" style="margin-top:40px">
            <h3>Quy định dịch vụ</h3>
            <div style="display:flex;gap:24px">
                <div style="flex:1">
                    <h4>Giá bao gồm</h4>
                    <ul>
                        <?php foreach (explode("\n", $gia_bao_gom) as $line): ?>
                            <li><?= esc_html($line) ?></li>
                        <?php endforeach; ?>
                    </ul>
                </div>
                <div style="flex:1">
                    <h4>Giá không bao gồm</h4>
                    <ul>
                        <?php foreach (explode("\n", $gia_khong_bao_gom) as $line): ?>
                            <li><?= esc_html($line) ?></li>
                        <?php endforeach; ?>
                    </ul>
                </div>
            </div>
        </div>

        <div id="hoi-dap" style="margin-top:40px">
            <h3>Hỏi đáp</h3>
            <p>Chúng tôi sẽ bổ sung mục hỏi đáp sau.</p>
        </div>
    </div>
</div>

<?php get_footer(); ?>
